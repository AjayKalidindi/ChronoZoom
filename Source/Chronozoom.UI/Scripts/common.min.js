var ChronoZoom;(function(n){(function(){function d(t){if(timings.wcfRequestCompleted=new Date,Load(n,t.d),timings.layoutCompleted=new Date,r&&(u=navStringToVisible(r.substring(1),n)),p(),!u&&i&&(window.location.hash=i,u=navStringToVisible(i,n)),u){n.virtualCanvas("setVisible",u),w(n,f);var e=n.virtualCanvas("getViewport");g(e),r&&window.location.hash!==r&&(hashChangeFromOutside=!1,window.location.hash=r)}timings.canvasInited=new Date}function p(){var r,t,u,f,o,s;e&&e.d.length>0&&(r=function(t){if(!t)return null;var i=n.virtualCanvas("findElement","t"+t.UniqueID);return k.push(i),i&&(i=vcelementToNavString(i)),i},t=e.d[0],i=r(t),navigationAnchor=n.virtualCanvas("findElement","t"+t.UniqueID),u=FindChildTimeline(t,earthTimelineID),h=r(u),f=FindChildTimeline(u,lifeTimelineID),c=r(f),o=FindChildTimeline(f,prehistoryTimelineID),l=r(o),s=FindChildTimeline(o,humanityTimelineID,!0),a=r(s),maxPermitedVerticalRange={top:t.y,bottom:t.y+t.height},maxPermitedScale=navStringToVisible(i,n).scale*1.1)}function w(n,t){var i=n.virtualCanvas("getViewport"),r=i.pointScreenToVirtual(0,0),u=i.pointScreenToVirtual(i.width,i.height);t.axis("setRange",r.x,u.x)}function g(n){var u=function(n){if(Math.abs(n)<1e-11)return 0;var t=Math.log(n)/2.3025850929940459,i=Math.pow(t,3)*Math.exp(-t*.001);return(t+i)*137e8/1041.2113538234403},i=n.pointScreenToVirtual(0,0).x,t;i<maxPermitedTimeRange.left&&(i=maxPermitedTimeRange.left),t=n.pointScreenToVirtual(n.width,n.height).x,t>maxPermitedTimeRange.right&&(t=maxPermitedTimeRange.right);var o=u(Math.abs(t)),f=u(Math.abs(i)),h=Math.max(2/s,Math.abs(o-f)),c=document.getElementById("cosmos_rect").clientWidth,r=301-s*f,e=s*h;r<0||r+e>c+5||(v.css("left",r),v.css("width",e))}var b,r,f,n,u,i,h,c,l,a,e,k=[],s,v,o=undefined,t=undefined,y=null})(n.Common||(n.Common={}));var t=n.Common})(ChronoZoom||(ChronoZoom={}))