var ChronoZoom;(function(n){(function(){function o(n){var t=setVisibleByUserDirectly(n.newvisible);t&&(setNavigationStringTo={element:n.element,id:t})}function s(n){var t=h(vc.virtualCanvas("getLayerContent"),n),i;t?(i=getVisibleForElement(t,1,vc.virtualCanvas("getViewport")),o({element:t,newvisible:i})):alert("Element not found in the content.")}function h(n,t){var r=t.charAt(0)==="c",i=function(n,t){var e,u,f,o,s;if(n.id===t)return n;if(!n.children)return null;for(e=n.children.length,u=0;u<e;u++)if(f=n.children[u],f.id===t)return f;for(u=0;u<e;u++)if(f=n.children[u],o=i(f,t),o)return o;return r&&n.type==="infodot"&&(s=getContentItem(n,t),s!=null)?s:null};return i(n,t)}function u(n,t){var u,o,h;(e($("#searchTextBox")[0].value).indexOf(n)===0||n==="")&&(u=$("#search .searchResults").empty(),t==null||(t.length==0?$("<div class='searchNoResult'>No results<\/div>").appendTo(u):(o=function(n,i){for(var o=!0,r,e,f=0;f<t.length;f++)if(r=t[f],r.ObjectType==n){switch(r.ObjectType){case 0:e="e"+r.UniqueID;break;case 1:e="t"+r.UniqueID;break;case 2:e="c"+r.UniqueID;break;default:continue}o&&($("<div class='searchResultSection'>"+i+"<\/div>").appendTo(u),o=!1),$("<div class='searchResult' resultId='"+e+"'>"+t[f].Title+"<\/div>").appendTo(u).click(function(){s(this.getAttribute("resultId"))})}},o(1,"Timelines"),o(0,"Exhibits"),o(2,"Artifacts")))),r&&(r=!1),i!=null&&(h=i,i=null,f(h)),$("#loadingImage").fadeOut("slow")}function f(n){if(r){i=n;return}if(r=!0,!n||n===""){setTimeout(function(){u(n,null)},1);return}var t;switch(czDataSource){case"db":t="Chronozoom.svc/Search";break;default:t="Chronozoom.svc/SearchRelay"}$.ajax({cache:!1,type:"GET",async:!0,dataType:"json",data:{searchTerm:n},url:t,success:function(result){czDataSource=="db"?u(n,result.d):u(n,eval(result.d))},error:function(n){alert("Error connecting to service: "+n.responseText)}})}function e(n){return n===null?"":(n&&(n=n.replace(new RegExp('"',"g"),"")),n)}var n=!1,t=null,i=null,r=!1})(n.Search||(n.Search={}));var t=n.Search})(ChronoZoom||(ChronoZoom={}))